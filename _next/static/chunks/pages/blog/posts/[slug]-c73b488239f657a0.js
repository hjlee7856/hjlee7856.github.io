(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{3239:(t,e,l)=>{"use strict";l.r(e),l.d(e,{__N_SSG:()=>N,default:()=>P});var n=l(7876),s=l(6894),i=l(4584),a=l(6520),r=l(2594),o=l(5591),d=l(6455),u=l(2009),c=l(4232);let x=t=>{var e,l,x;let{slug:h}=t,{user:m}=(0,i.A)(),[j,A]=(0,c.useState)(""),g=(0,u.rJ)(s.db,"posts",h,"comments"),p=async()=>{j.trim()&&(await (0,u.gS)(g,{content:j,createdAt:u.Dc.now(),user:m}),A(""))};return(0,n.jsxs)(a.A,{display:"flex",alignItems:"flex-start",gap:2,mb:2,children:[(0,n.jsx)(r.A,{src:null!==(l=null==m?void 0:m.photo)&&void 0!==l?l:"",children:null!==(x=null==m?void 0:null===(e=m.name)||void 0===e?void 0:e[0])&&void 0!==x?x:"이"}),(0,n.jsx)(o.A,{fullWidth:!0,multiline:!0,placeholder:m?"댓글을 입력하세요...":"댓글을 작성하려면 로그인 하세요.",value:j,onChange:t=>A(t.target.value),size:"small",disabled:!m}),(0,n.jsx)(d.A,{variant:"contained",onClick:p,disabled:!j.trim()||!m,children:"작성"})]})};var h=l(2460),m=l(7268);let j=t=>{let{comment:e,slug:l}=t,[x,j]=(0,c.useState)(null),[A,g]=(0,c.useState)(""),{user:p}=(0,i.A)(),v=(null==p?void 0:p.uid)===e.user.uid,f=x===e.id,b=async t=>{window.confirm("댓글을 삭제하시겠습니까?")&&await (0,u.kd)((0,u.H9)(s.db,"posts",l,"comments",t))},y=async t=>{A.trim()&&(await (0,u.mZ)((0,u.H9)(s.db,"posts",l,"comments",t),{content:A}),j(null))};return(0,n.jsxs)(h.A,{variant:"outlined",sx:{p:2},children:[(0,n.jsxs)(a.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:[(0,n.jsx)(r.A,{src:e.user.photo,children:e.user.name[0]}),(0,n.jsx)(m.A,{fontWeight:"bold",children:e.user.name}),(0,n.jsx)(m.A,{variant:"body2",color:"text.secondary",children:e.createdAt.toDate().toLocaleString()})]}),f?(0,n.jsxs)(a.A,{display:"flex",flexDirection:"column",gap:1,children:[(0,n.jsx)(o.A,{multiline:!0,fullWidth:!0,value:A,onChange:t=>g(t.target.value)}),(0,n.jsxs)(a.A,{display:"flex",gap:1,justifyContent:"flex-end",children:[(0,n.jsx)(d.A,{variant:"contained",size:"small",onClick:()=>y(e.id),children:"저장"}),(0,n.jsx)(d.A,{variant:"outlined",size:"small",onClick:()=>j(null),children:"취소"})]})]}):(0,n.jsx)(m.A,{children:e.content}),v&&!f&&(0,n.jsxs)(a.A,{display:"flex",gap:1,mt:1,justifyContent:"flex-end",children:[(0,n.jsx)(d.A,{variant:"outlined",size:"small",onClick:()=>{j(e.id),g(e.content)},children:"수정"}),(0,n.jsx)(d.A,{variant:"outlined",size:"small",color:"error",onClick:()=>b(e.id),children:"삭제"})]})]},e.id)};var A=l(7263);let g=t=>{let{slug:e,comments:l,start:s,perPage:i}=t;return(0,n.jsx)(A.A,{spacing:2,children:l.slice(s,s+i).map(t=>(0,n.jsx)(j,{comment:t,slug:e}))})};var p=l(8143),v=l(5965),f=l(3830);function b(t){let{slug:e}=t,[l,i]=(0,c.useState)([]),[r,o]=(0,c.useState)(!0),{currentPage:d,setCurrentPage:h,totalPages:j,perPage:A}=(0,p.W)(l.length),b=(0,u.rJ)(s.db,"posts",e,"comments");return(0,c.useEffect)(()=>{let t=(0,u.P)(b,(0,u.My)("createdAt","desc")),e=(0,u.aQ)(t,t=>{i(t.docs.map(t=>({id:t.id,...t.data()}))),o(!1)});return()=>e()},[e]),(0,n.jsxs)(a.A,{children:[(0,n.jsx)(m.A,{variant:"h5",fontWeight:"bold",mb:2,mt:2,gutterBottom:!0,children:"Comment"}),(0,n.jsx)(x,{slug:e}),r?(0,n.jsx)(v.A,{}):(0,n.jsx)(g,{slug:e,comments:l,start:(d-1)*A,perPage:A}),(0,n.jsx)(a.A,{display:"flex",justifyContent:"center",my:3,children:(0,n.jsx)(f.A,{count:j,page:d,onChange:(t,e)=>h(e),color:"primary",shape:"rounded"})})]})}let y=(t,e)=>{let[l,n]=(0,c.useState)(null);return(0,c.useEffect)(()=>{let l=(0,u.H9)(s.db,"posts",t),i=(0,u.aQ)(l,t=>{if(t.exists()){let l=t.data();n({category:e.category,title:e.title,subTitle:e.subTitle,author:e.author,thumbnail:e.thumbnail,createdAt:l.createdAt,slug:l.slug,viewCount:l.viewCount,likeCount:l.likeCount})}});return()=>i()},[t]),l},C=async t=>{let e=(0,u.H9)(s.db,"posts",t);(await (0,u.x7)(e)).exists()&&await (0,u.mZ)(e,{viewCount:(0,u.GV)(1)})},w=t=>{(0,c.useEffect)(()=>{C(t)},[t])};var _=l(8583),k=l(7916),S=l(3644),E=l(4587),W=l.n(E),N=!0;function P(t){let{mdxSource:e,meta:l,slug:s}=t;w(s);let i=y(s,l);return i?(0,n.jsxs)(_.A,{maxWidth:"md",children:[(0,n.jsxs)(a.A,{mb:4,mt:2,children:[(0,n.jsx)(m.A,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:i.title}),(0,n.jsx)(m.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:i.createdAt.toDate().toLocaleString()}),(0,n.jsx)(W(),{src:i.thumbnail,alt:"썸네일 이미지",width:150,height:150})]}),i&&(0,n.jsxs)(a.A,{gap:0,children:[(0,n.jsxs)(m.A,{sx:{m:1},variant:"body2",children:["조회수: ",i.viewCount]}),(0,n.jsxs)(m.A,{sx:{m:1},variant:"body2",children:["좋아요: ",i.likeCount]})]}),(0,n.jsx)(S.m,{...e}),(0,n.jsx)(k.A,{}),(0,n.jsx)(b,{slug:s})]}):(0,n.jsx)(v.A,{})}},7516:(t,e,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/posts/[slug]",function(){return l(3239)}])},8143:(t,e,l)=>{"use strict";l.d(e,{W:()=>s});var n=l(4232);let s=t=>{let[e,l]=(0,n.useState)(1);return{totalPages:Math.ceil(t/5),currentPage:e,setCurrentPage:l,perPage:5}}}},t=>{var e=e=>t(t.s=e);t.O(0,[573,581,636,593,792],()=>e(7516)),_N_E=t.O()}]);