(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{1526:(e,t,s)=>{"use strict";s.r(t),s.d(t,{__N_SSG:()=>V,default:()=>Z});var l=s(7876),r=s(2460),n=s(2039),i=s(1428);let a=e=>{let{about:t}=e;return(0,l.jsx)(r.A,{variant:"outlined",children:(0,l.jsxs)(n.A,{children:[(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",fontWeight:"bold",marginBottom:2,children:"소개글"}),(0,l.jsx)(i.A,{variant:"body2",color:"text.secondary",children:t.split("<br/>").map((e,t)=>(0,l.jsxs)("span",{children:[e,(0,l.jsx)("br",{})]},t))})]})})};var o=s(1662),d=s(6520),c=s(7916),x=s(4e3);let u=e=>{let{title:t,posts:s,type:a}=e,u=(0,x.useRouter)();return(0,l.jsx)(r.A,{variant:"outlined",children:(0,l.jsxs)(n.A,{sx:{pb:"16px !important"},children:[(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",fontWeight:"bold",marginBottom:2,children:t}),(0,l.jsx)(d.A,{gap:1,display:"flex",flexDirection:"column",children:s&&s.map(e=>(0,l.jsxs)(d.A,{children:[(0,l.jsxs)(d.A,{display:"flex",justifyContent:"space-between",sx:{cursor:"pointer"},onClick:()=>{u.push("/posts/".concat(e.slug))},children:[(0,l.jsx)(i.A,{variant:"body1",sx:{width:"150px"},noWrap:!0,children:e.title}),"recent"===a&&(0,l.jsx)(i.A,{variant:"body2",noWrap:!0,children:e.createdAt.toLocaleDateString()}),"popular"===a&&(0,l.jsxs)(d.A,{display:"flex",gap:.5,alignItems:"center",justifyContent:"flex-end",width:"50px",children:[(0,l.jsx)(o.A,{color:"disabled",fontSize:"small"}),(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",children:e.viewCount})]})]}),(0,l.jsx)(c.A,{})]},e.slug))})]})})},p=e=>{let{popularPosts:t,recentPosts:s,about:r}=e;return(0,l.jsxs)(d.A,{component:"aside",sx:{width:400,pt:1,gap:1,display:{xs:"none",sm:"flex"}},flexDirection:"column",children:[(0,l.jsx)(a,{about:r}),(0,l.jsx)(u,{title:"인기 포스트",posts:t,type:"popular"}),(0,l.jsx)(u,{title:"최근 포스트",posts:s,type:"recent"})]})};var h=s(1648),j=s(7030),f=s(882);let v=e=>{let{changeCategory:t,value:s,setCurrentPage:r}=e;return(0,l.jsx)(d.A,{display:"flex",justifyContent:"flex-start",sx:{borderBottom:1,borderColor:"divider"},children:(0,l.jsx)(j.A,{value:s,onChange:(e,s)=>{t(e,s),r(1)},variant:"scrollable",children:h.L.map((e,t)=>(0,l.jsx)(f.A,{label:e.categoryName},t))})})};var A=s(3932),m=s(6894),y=s(2009);let b=async(e,t)=>{let s=(0,y.H9)(m.db,"users",t,"likes",e),l=(0,y.H9)(m.db,"posts",e);(await (0,y.x7)(s)).exists()||(await (0,y.BN)(s,{createdAt:new Date}),await (0,y.mZ)(l,{likeCount:(0,y.GV)(1)}))},g=async(e,t)=>{let s=(0,y.H9)(m.db,"users",t,"likes",e),l=(0,y.H9)(m.db,"posts",e);(await (0,y.x7)(s)).exists()&&(await (0,y.kd)(s),await (0,y.mZ)(l,{likeCount:(0,y.GV)(-1)}))},w=async(e,t)=>{let s=(0,y.H9)(m.db,"users",t,"likes",e);return(await (0,y.x7)(s)).exists()};var C=s(197),k=s(4232);let S=e=>{let[t,s]=(0,k.useState)(!1),{user:l}=(0,C.A)();return(0,k.useEffect)(()=>{(async()=>{if(!(null==l?void 0:l.uid)){s(!1);return}s(await w(e.slug,l.uid))})()},[null==l?void 0:l.uid,e.slug]),{handleLike:async()=>{if(null==l?void 0:l.uid)if(t){var r;(null!==(r=e.likeCount)&&void 0!==r?r:0)>0&&await g(e.slug,l.uid),s(!1)}else await b(e.slug,l.uid),s(!0);else alert("로그인이 필요한 서비스 입니다.")},likeActive:t}};var _=s(4687),B=s(2318),E=s(772);let W=e=>{let{post:t}=e,{handleLike:s,likeActive:r}=S(t);return(0,l.jsxs)(d.A,{display:"flex",justifyContent:"space-between",sx:{marginTop:{xs:2,sm:0}},children:[(0,l.jsxs)(d.A,{display:"flex",gap:.5,alignItems:{xs:"flex-start",sm:"center"},flexDirection:{xs:"column",sm:"row"},children:[(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",children:t.author}),(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",display:{xs:"none",sm:"block"},children:"•"}),(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",children:t.createdAt&&t.createdAt.toLocaleDateString()})]}),(0,l.jsxs)(d.A,{display:"flex",gap:1,alignItems:{xs:"flex-end",sm:"center"},children:[(0,l.jsxs)(d.A,{display:"flex",gap:.5,alignItems:"center",children:[(0,l.jsx)(o.A,{color:"disabled",fontSize:"small"}),(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",children:t.viewCount})]}),(0,l.jsxs)(d.A,{display:"flex",gap:.5,alignItems:"center",onClick:e=>{e.stopPropagation(),s()},children:[r?(0,l.jsx)(B.A,{color:"disabled",fontSize:"small"}):(0,l.jsx)(E.A,{color:"disabled",fontSize:"small"}),(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",children:t.likeCount})]}),(0,l.jsxs)(d.A,{display:"flex",gap:.5,alignItems:"center",children:[(0,l.jsx)(_.A,{color:"disabled",fontSize:"small"}),(0,l.jsx)(i.A,{variant:"body2",color:"textSecondary",children:t.commentCount})]})]})]})};var D=s(4587),P=s.n(D);let I=e=>{let{post:t}=e;return(0,l.jsx)(d.A,{position:"relative",borderRadius:"8px",overflow:"hidden",sx:{width:{xs:"120px",sm:"180px"},height:{xs:"67.5px",sm:"101.25px"},flexShrink:0,margin:{xs:0,sm:1}},children:(0,l.jsx)(P(),{src:t.thumbnail,alt:"썸네일 이미지",fill:!0})})},N=e=>{let{post:t}=e;return(0,l.jsxs)(d.A,{position:"relative",width:"100%",children:[(0,l.jsx)(i.A,{variant:"h6",gutterBottom:!0,sx:{maxWidth:"95%",wordBreak:"break-word",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.title}),(0,l.jsx)(i.A,{variant:"subtitle1",color:"textSecondary",gutterBottom:!0,sx:{maxWidth:"95%",wordBreak:"break-word",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.subTitle})]})};var z=s(1480);let H=e=>{let{post:t}=e,s=(0,z.useRouter)();return(0,l.jsx)(r.A,{variant:"outlined",sx:{my:1,borderRadius:"8px","&:hover":{cursor:"pointer"}},onClick:()=>s.push("/posts/".concat(t.slug)),children:(0,l.jsx)(n.A,{sx:{pb:"16px !important"},children:(0,l.jsxs)(d.A,{display:"flex",justifyContent:"space-between",minWidth:"",children:[(0,l.jsxs)(d.A,{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between",sx:{mr:{xs:0,sm:2}},children:[(0,l.jsxs)(d.A,{sx:{display:{xs:"flex"},flex:{xs:"1"},flexDirection:{xs:"row"}},justifyContent:"space-between",children:[(0,l.jsx)(N,{post:t}),(0,l.jsx)(d.A,{sx:{display:{xs:"flex",sm:"none"},alignItems:"center"},children:(0,l.jsx)(I,{post:t})})]}),(0,l.jsx)(W,{post:t})]}),(0,l.jsx)(d.A,{sx:{display:{xs:"none",sm:"flex"},alignItems:"center"},children:(0,l.jsx)(I,{post:t})})]})})})};var L=s(964);let T=e=>{let{filteredPosts:t}=e;return(0,l.jsx)(L.A,{sx:{paddingX:"0 !important"},children:t.map((e,t)=>(0,l.jsx)(H,{post:e},t))})};var M=s(6786),O=s(8143);let R=()=>{let[e,t]=(0,k.useState)([]);return(0,k.useEffect)(()=>{let e=(0,y.rJ)(m.db,"posts"),s=(0,y.aQ)((0,y.P)(e,(0,y.My)("viewCount","desc"),(0,y.AB)(5)),e=>{t(e.docs.map(e=>{let t=e.data();return console.log(t),{...t,createdAt:t.createdAt.toDate()}}))},e=>{console.error("Error fetching most viewed posts:",e)});return()=>{s()}},[]),{popularPosts:e}},G=()=>{let[e,t]=(0,k.useState)([]);return(0,k.useEffect)(()=>{let e=(0,y.rJ)(m.db,"posts"),s=(0,y.aQ)((0,y.P)(e,(0,y.My)("createdAt","desc"),(0,y.AB)(5)),e=>{t(e.docs.map(e=>{let t=e.data();return console.log(t),{...t,createdAt:t.createdAt.toDate()}}))},e=>{console.error("Error fetching most viewed posts:",e)});return()=>{s()}},[]),{recentPosts:e}},J=async e=>{e.forEach(async e=>{let t=(0,y.H9)(m.db,"posts",e.slug);(await (0,y.x7)(t)).exists()||await (0,y.BN)(t,{slug:e.slug,title:e.title,viewCount:0,likeCount:0,createdAt:new Date})})},Q=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,[l,r]=(0,k.useState)([]);return(0,k.useEffect)(()=>{if(!e.length)return;J(e);let l=(0,y.rJ)(m.db,"posts"),n=(t-1)*s,i=e.slice(n,n+s).map(e=>e.slug),a=(0,y.P)(l,(0,y._M)("slug","in",i)),o=(0,y.aQ)(a,t=>{try{let s={};t.forEach(e=>{s[e.id]=e.data()});let l=e.map(e=>{var t,l,r;let n=s[e.slug];return{...e,...n,createdAt:null!==(r=null==n?void 0:null===(l=n.createdAt)||void 0===l?void 0:null===(t=l.toDate)||void 0===t?void 0:t.call(l))&&void 0!==r?r:null}}).sort((e,t)=>{var s,l,r,n,i,a;let o=null!==(i=null===(l=e.createdAt)||void 0===l?void 0:null===(s=l.getTime)||void 0===s?void 0:s.call(l))&&void 0!==i?i:0;return(null!==(a=null===(n=t.createdAt)||void 0===n?void 0:null===(r=n.getTime)||void 0===r?void 0:r.call(n))&&void 0!==a?a:0)-o});r(l)}catch(e){}},e=>{});return()=>o()},[e,t]),{postWithMeta:l}};var X=s(3830),V=!0;function Z(e){let{posts:t}=e,{currentPage:s,setCurrentPage:r,totalPages:n,perPage:i}=(0,O.W)(t.length),{postWithMeta:a}=Q(t,s,i),{filteredPosts:o,changeCategory:x,selectIdx:u}=(0,M.e)(a),{popularPosts:h}=R(),{recentPosts:j}=G();return t?(0,l.jsxs)(d.A,{display:"flex",children:[(0,l.jsxs)(d.A,{flex:1,children:[(0,l.jsx)(v,{changeCategory:x,setCurrentPage:r,value:u}),(0,l.jsx)(T,{filteredPosts:o}),(0,l.jsx)(d.A,{display:"flex",justifyContent:"center",my:3,children:(0,l.jsx)(X.A,{count:n,page:s,onChange:(e,t)=>r(t),color:"primary",shape:"rounded"})})]}),(0,l.jsx)(c.A,{orientation:"vertical",flexItem:!0,sx:{mx:4,display:{xs:"none",sm:"block"}}}),(0,l.jsx)(p,{popularPosts:h,recentPosts:j,about:"포트폴리오 겸 개발 문서 정리용 블로그입니다. <br/> 그 외 유틸기능을 제공합니다."})]}):(0,l.jsx)(A.A,{})}},3932:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var l=s(7876),r=s(6520),n=s(5965);let i=()=>(0,l.jsx)(r.A,{sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(n.A,{})})},6760:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(1526)}])},8143:(e,t,s)=>{"use strict";s.d(t,{W:()=>r});var l=s(4232);let r=e=>{let[t,s]=(0,l.useState)(1);return{totalPages:Math.ceil(e/5),currentPage:t,setCurrentPage:s,perPage:5}}}},e=>{var t=t=>e(e.s=t);e.O(0,[573,340,636,593,792],()=>t(6760)),_N_E=e.O()}]);