(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[119],{3853:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var l=n(7876),i=n(1522),a=n(2781),s=n(1567),r=n(4676),o=n(9858),c=n(144),d=n(6448),x=n(4527),h=n(7461),u=n(4232);let g=e=>{let[t,n]=(0,u.useState)(""),[i,g]=(0,u.useState)(""),j=()=>{n(""),g(""),e.setIsAdding(!1)};return(0,l.jsxs)(r.A,{sx:{backgroundColor:h.A[50]},children:[(0,l.jsx)(o.A,{children:(0,l.jsx)(c.A,{error:""===t,label:""===t?"필수":"카테고리",value:t,onChange:e=>n(e.target.value),multiline:!0,fullWidth:!0,size:"small"})}),(0,l.jsx)(o.A,{children:(0,l.jsx)(c.A,{label:"내용",value:i,onChange:e=>g(e.target.value),multiline:!0,fullWidth:!0,size:"small"})}),(0,l.jsxs)(o.A,{align:"center",children:[(0,l.jsx)(d.A,{title:"저장",children:(0,l.jsx)(x.A,{onClick:()=>{e.handleAdd(e.section,t,i),j(),e.setIsAdding(!1)},size:"small",children:(0,l.jsx)(s.A,{fontSize:"small"})})}),(0,l.jsx)(d.A,{title:"취소",children:(0,l.jsx)(x.A,{onClick:j,size:"small",children:(0,l.jsx)(a.A,{fontSize:"small"})})})]})]})};var j=n(2989),A=n(5878),m=n(4776),f=n(6149),p=n(6115),y=n(6520),v=n(1428),b=n(451),k=n(8423),C=n(1413),w=n(1259),S=n(4582);let E=e=>{let[t,n]=(0,u.useState)(!1);return(0,l.jsxs)(y.A,{sx:{overflowX:"auto",minHeight:"200px"},children:[(0,l.jsxs)(y.A,{display:"flex",alignItems:"center",children:[(0,l.jsx)(v.A,{variant:"subtitle1",fontWeight:"bold",children:e.section}),(0,l.jsx)(d.A,{title:"추가하기",children:(0,l.jsx)(x.A,{onClick:()=>{n(!0)},size:"small",children:(0,l.jsx)(j.A,{fontSize:"small"})})})]}),(0,l.jsxs)(b.A,{size:"small",sx:{minWidth:300},children:[(0,l.jsx)(k.A,{children:(0,l.jsxs)(r.A,{children:[(0,l.jsx)(o.A,{children:"카테고리"}),(0,l.jsx)(o.A,{children:"내용"}),(0,l.jsx)(o.A,{align:"center",children:"메뉴"})]})}),(0,l.jsxs)(C.A,{children:[t&&(0,l.jsx)(g,{section:e.section,handleAdd:e.handleAdd,setIsAdding:n}),e.allContentItems.map((t,n)=>{var d,h,u,g,j,y;let v="".concat(t.section,"-").concat(t.category,"-").concat(t.content),b=e.editingKey===v;return(0,l.jsxs)(r.A,{sx:{backgroundColor:b?S.A[50]:""},children:[(0,l.jsx)(o.A,{sx:{wordBreak:"break-all"},children:b?(0,l.jsx)(c.A,{error:(null===(d=e.editingMap[t.content])||void 0===d?void 0:d.category)==="",label:(null===(h=e.editingMap[t.content])||void 0===h?void 0:h.category)===""?"필수":"카테고리",value:null!==(j=null===(u=e.editingMap[t.content])||void 0===u?void 0:u.category)&&void 0!==j?j:t.category,onChange:n=>e.handleEditChange(t.content,"category",n.target.value),multiline:!0,fullWidth:!0,size:"small"}):t.category}),(0,l.jsx)(o.A,{sx:{wordBreak:"break-all"},children:b?(0,l.jsx)(c.A,{label:"내용",value:null!==(y=null===(g=e.editingMap[t.content])||void 0===g?void 0:g.content)&&void 0!==y?y:t.content,onChange:n=>e.handleEditChange(t.content,"content",n.target.value),multiline:!0,fullWidth:!0,disabled:!b,size:"small"}):t.content}),(0,l.jsx)(o.A,{align:"center",children:(0,l.jsx)(i.A,{menuBtn:(0,l.jsx)(x.A,{children:(0,l.jsx)(m.A,{})}),menuItems:[b&&"금일 진행 사항"===t.section&&(0,l.jsxs)(w.A,{onClick:()=>{e.handleEditChange(t.content,"section","익일 예정 사항"),e.handleSaveEdit(t.content,"익일 예정 사항")},children:[(0,l.jsx)(p.A,{fontSize:"small",sx:{mr:1}}),"익일로 이동"]},"to-tomorrow"),b&&"익일 예정 사항"===t.section&&(0,l.jsxs)(w.A,{onClick:()=>{e.handleEditChange(t.content,"section","금일 진행 사항"),e.handleSaveEdit(t.content,"금일 진행 사항")},children:[(0,l.jsx)(f.A,{fontSize:"small",sx:{mr:1}}),"금일로 이동"]},"to-today"),b?(0,l.jsxs)(w.A,{onClick:()=>{e.handleSaveEdit(t.content),e.setEditingKey(null)},children:[(0,l.jsx)(s.A,{fontSize:"small",sx:{mr:1}}),"저장"]},"save"):(0,l.jsxs)(w.A,{onClick:()=>{e.setEditingMap(e=>({...e,[t.content]:{section:t.section,category:t.category,content:t.content}})),e.setEditingKey("".concat(t.section,"-").concat(t.category,"-").concat(t.content))},children:[(0,l.jsx)(A.A,{fontSize:"small",sx:{mr:1}}),"수정"]},"edit"),(0,l.jsxs)(w.A,{onClick:()=>e.handleDelete(t.section,t.category,t.content),children:[(0,l.jsx)(a.A,{fontSize:"small",sx:{mr:1}}),"삭제"]},"delete")]})})]},n)})]})]})]})},z=e=>(0,l.jsxs)(y.A,{flex:1,flexDirection:"column",children:[(0,l.jsx)(y.A,{mb:1,children:(0,l.jsx)(v.A,{variant:"subtitle1",fontWeight:"bold",children:"미리보기"})}),(0,l.jsx)(c.A,{onClick:e.handleCopy,multiline:!0,fullWidth:!0,minRows:10,value:e.text,sx:{borderRadius:2,backgroundColor:"#f5f5f5"},slotProps:{input:{readOnly:!0},htmlInput:{sx:{cursor:"pointer"}}}}),(0,l.jsx)(v.A,{variant:"subtitle2",color:"textSecondary",align:"center",children:"클릭하면 클립보드에 복사됩니다."})]}),D=()=>(0,l.jsxs)(y.A,{children:[(0,l.jsx)(v.A,{variant:"h5",fontWeight:"bold",children:"업무 보고 생성기"}),(0,l.jsxs)(v.A,{variant:"body2",color:"text.secondary",mt:.5,children:["업무 보고를 템플릿으로 자동으로 생성 해줍니다. ",(0,l.jsx)("br",{}),"로그인하면 클라우드에 저장됩니다."]})]});var O=n(6924),I=n(2009);let _=async(e,t)=>{try{let n=(0,I.H9)(O.db,"workReports",t.uid);(await (0,I.x7)(n)).exists()?await (0,I.mZ)(n,{workReportData:e,updatedAt:new Date}):await (0,I.BN)(n,{workReportData:e,createdAt:new Date})}catch(e){console.error("Failed to edit work report:",e)}},M=async e=>{try{let t=(0,I.H9)(O.db,"workReports",e.uid),n=await (0,I.x7)(t);if(n.exists())return JSON.parse(n.data().workReportData);return null}catch(e){return null}};var N=n(197);let W="workReportData",R=()=>{let[e,t]=(0,u.useState)({}),[n,l]=(0,u.useState)({}),[i,a]=(0,u.useState)(null),[s,r]=(0,u.useState)(!1),{user:o}=(0,N.A)();(0,u.useEffect)(()=>{(async()=>{if(o){let e=await M(o);e&&t(e)}else{let e=localStorage.getItem(W);e&&t(JSON.parse(e))}})()},[o]),(0,u.useEffect)(()=>{(async()=>{o?await _(JSON.stringify(e),o):localStorage.setItem(W,JSON.stringify(e))})()},[e,o]);let c=async()=>{let e=d();await navigator.clipboard.writeText(e),r(!0)},d=()=>Object.entries(e).sort((e,t)=>{let[n]=e,[l]=t;return n.localeCompare(l)}).map(e=>{let[t,n]=e,l=Object.entries(n).map(e=>{let[t,n]=e,l=n.filter(e=>""!==e.trim());if(0===l.length)return"● ".concat(t);let i=l.map(e=>"    ○ ".concat(e)).join("\n");return t.trim()?"● ".concat(t,"\n").concat(i):i}).join("\n");return l?"".concat("*[".concat(t,"]*"),"\n").concat(l):""}).join("\n\n").trim(),x=d(),h=Object.entries(e).flatMap(e=>{let[t,n]=e;return Object.entries(n).flatMap(e=>{let[n,l]=e;return l.map(e=>({section:t,category:n,content:e}))})});return{handleAdd:(e,n,l)=>{e&&n&&t(t=>{let i={...t};return i[e]=i[e]||{},i[e][n]=[...i[e][n]||[],l],i})},allContentItems:h,editingMap:n,editingKey:i,handleEditChange:(e,t,n)=>{l(l=>({...l,[e]:{...l[e],[t]:n}}))},handleSaveEdit:(e,i)=>{let a=n[e];if(!a)return;let s=h.find(t=>t.content===e);if(!s)return;let r=i||a.section,o=a.category,c=a.content;t(t=>{let n={...t};return n[s.section][s.category]=n[s.section][s.category].filter(t=>t!==e),0===n[s.section][s.category].length&&delete n[s.section][s.category],0===Object.keys(n[s.section]).length&&delete n[s.section],n[r]=n[r]||{},n[r][o]=[...n[r][o]||[],c],n}),l(t=>{let n={...t};return delete n[e],n})},setEditingMap:l,setEditingKey:a,handleDelete:(e,n,l)=>{t(t=>{let i={...t};return i[e][n]=i[e][n].filter(e=>e!==l),0===i[e][n].length&&delete i[e][n],0===Object.keys(i[e]).length&&delete i[e],i})},handleCopy:c,openSnackbar:s,text:x,setOpenSnackbar:r}};var K=n(7263),B=n(7916),H=n(2199);let J=()=>{let{handleAdd:e,allContentItems:t,editingMap:n,editingKey:i,handleEditChange:a,handleSaveEdit:s,setEditingMap:r,setEditingKey:o,handleDelete:c,handleCopy:d,openSnackbar:x,text:h,setOpenSnackbar:u}=R();return(0,l.jsxs)(y.A,{p:2,children:[(0,l.jsxs)(K.A,{spacing:3,children:[(0,l.jsx)(D,{}),(0,l.jsx)(B.A,{}),(0,l.jsxs)(y.A,{display:"flex",sx:{flexDirection:{xs:"column",sm:"row"}},children:[(0,l.jsxs)(y.A,{display:"flex",flexDirection:"column",gap:8,flex:2,children:[(0,l.jsx)(E,{allContentItems:t.filter(e=>"금일 진행 사항"===e.section),editingMap:n,setEditingMap:r,editingKey:i,setEditingKey:o,handleEditChange:a,handleSaveEdit:s,handleDelete:c,section:"금일 진행 사항",handleAdd:e}),(0,l.jsx)(E,{allContentItems:t.filter(e=>"익일 예정 사항"===e.section),editingMap:n,setEditingMap:r,editingKey:i,setEditingKey:o,handleEditChange:a,handleSaveEdit:s,handleDelete:c,section:"익일 예정 사항",handleAdd:e})]}),(0,l.jsx)(B.A,{orientation:"vertical",flexItem:!0,sx:{mx:3,display:{xs:"none",sm:"block"}}}),(0,l.jsx)(B.A,{sx:{my:3,display:{xs:"block",sm:"none"}}}),(0,l.jsx)(z,{text:h,handleCopy:d})]})]}),(0,l.jsx)(H.A,{open:x,autoHideDuration:2e3,onClose:()=>u(!1),message:"보고서가 클립보드에 복사되었습니다.",anchorOrigin:{vertical:"bottom",horizontal:"center"}})]})}},8569:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/utils/work-report-maker",function(){return n(3853)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[144,199,794,636,593,792],()=>t(8569)),_N_E=e.O()}]);