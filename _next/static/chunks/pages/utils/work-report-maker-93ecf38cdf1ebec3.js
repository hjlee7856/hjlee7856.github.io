(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[119],{18569:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/utils/work-report-maker",function(){return n(77079)}])},77079:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>U});var i=n(37876),l=n(95252),s=n(80132),r=n(62382),a=n(92781),o=n(46520),d=n(61428),c=n(23410),x=n(36448),h=n(94527),g=n(93890),j=n(14694),u=n(42199),A=n(14232),m=n(86378);let p=()=>(0,i.jsxs)(o.A,{p:2,children:[(0,i.jsx)(m.A,{variant:"text",width:"60%",height:32,sx:{mb:1}}),(0,i.jsx)(m.A,{variant:"text",width:"80%",height:24,sx:{mb:1}}),(0,i.jsx)(m.A,{variant:"rectangular",width:"100%",height:120,sx:{mb:2}}),(0,i.jsxs)(o.A,{display:"flex",gap:2,children:[(0,i.jsx)(m.A,{variant:"rectangular",width:80,height:36}),(0,i.jsx)(m.A,{variant:"rectangular",width:80,height:36})]})]}),f=e=>{let[t,n]=(0,A.useState)(!1),[l,s]=(0,A.useState)(!1),[m,f]=(0,A.useState)(!1),[y,v]=(0,A.useState)(""),[w,S]=(0,A.useState)(!1),E=async()=>{await navigator.clipboard.writeText(y),S(!0)};return((0,A.useEffect)(()=>{let n=e.text.split("\n"),i=n[0];i=i.replace(/\s*\(오전 반차\)/,"").replace(/\s*\(오후 반차\)/,""),l?i+=" (오전 반차)":m&&(i+=" (오후 반차)"),n[0]=i;let s=n.join("\n");t&&(s+="\n@devops"),v(s)},[e.text,t,l,m]),e.isLoading)?(0,i.jsx)(p,{}):(0,i.jsxs)(o.A,{flex:1,flexDirection:"column",children:[(0,i.jsx)(o.A,{display:"flex",flex:1,mb:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:(0,i.jsx)(d.A,{variant:"subtitle1",fontWeight:"bold",children:"미리보기"})}),(0,i.jsxs)(o.A,{position:"relative",children:[(0,i.jsx)(c.A,{multiline:!0,fullWidth:!0,minRows:10,value:y,onChange:e=>v(e.target.value),sx:{borderRadius:2}}),(0,i.jsx)(x.A,{title:"클립보드에 복사",sx:{position:"absolute",right:1,top:1},children:(0,i.jsx)(h.A,{size:"small",onClick:E,children:(0,i.jsx)(r.A,{fontSize:"small"})})}),(0,i.jsx)(x.A,{title:"초기화",sx:{position:"absolute",right:1,bottom:1},children:(0,i.jsx)(h.A,{size:"small",onClick:()=>{window.confirm("정말 초기화하시겠습니까?")&&(n(!1),s(!1),f(!1),v(""),e.resetData())},children:(0,i.jsx)(a.A,{fontSize:"small",color:"error"})})})]}),(0,i.jsx)(g.A,{control:(0,i.jsx)(j.A,{checked:t,onChange:e=>n(e.target.checked)}),label:"개발팀"}),(0,i.jsx)(g.A,{control:(0,i.jsx)(j.A,{checked:l,onChange:e=>{s(e.target.checked),f(!1)}}),label:"오전반차"}),(0,i.jsx)(g.A,{control:(0,i.jsx)(j.A,{checked:m,onChange:e=>{s(!1),f(e.target.checked)}}),label:"오후반차"}),(0,i.jsx)(u.A,{open:w,autoHideDuration:2e3,onClose:()=>S(!1),message:"보고서가 클립보드에 복사되었습니다.",anchorOrigin:{vertical:"bottom",horizontal:"center"}})]})};var y=n(19474),v=n(35582),w=n(80609),S=n(84676),E=n(9858),b=n(37461);let C=e=>{let[t,n]=(0,A.useState)(""),[l,s]=(0,A.useState)(""),r=e.allContentItems.some(n=>n.section===e.section&&n.category===t&&n.content===l),a=()=>{r||(e.handleAdd(e.section,t,l),o(),e.setIsAdding(!1))},o=()=>{n(""),s(""),e.setIsAdding(!1)},d=e=>{"Enter"===e.key&&a()};return(0,i.jsxs)(S.A,{sx:{backgroundColor:b.A[50]},children:[(0,i.jsx)(E.A,{children:(0,i.jsx)(w.A,{fontSize:"small",color:"disabled"})}),(0,i.jsx)(E.A,{children:(0,i.jsx)(c.A,{error:""===t,label:""===t?"필수":"카테고리",value:t,onChange:e=>n(e.target.value),fullWidth:!0,size:"small",onKeyDown:d})}),(0,i.jsx)(E.A,{children:(0,i.jsx)(c.A,{error:r,label:r?"중복된 항목입니다":"내용",value:l,onChange:e=>s(e.target.value),fullWidth:!0,size:"small",onKeyDown:d})}),(0,i.jsxs)(E.A,{align:"right",children:[(0,i.jsx)(x.A,{title:r?"중복된 항목은 저장할 수 없습니다":"저장",children:(0,i.jsx)(h.A,{onClick:a,size:"small",disabled:r,children:(0,i.jsx)(y.A,{fontSize:"small",color:"success"})})}),(0,i.jsx)(x.A,{title:"취소",children:(0,i.jsx)(h.A,{onClick:o,size:"small",children:(0,i.jsx)(v.A,{fontSize:"small",color:"error"})})})]})]})};var k=n(14664),z=n(54287),O=n(92989),D=n(451),K=n(78423),M=n(1413),I=n(63727),R=n(75121),W=n(80744);let _={TODAY:"금일 진행 사항",TOMORROW:"익일 예정 사항"},N=e=>{let{item:t,editingKey:n,handleSaveEdit:l,setEditingKey:s}=e;return n?(0,i.jsxs)(o.A,{display:"flex",justifyContent:"flex-end",children:[(0,i.jsx)(x.A,{title:"저장",children:(0,i.jsx)(h.A,{onClick:e=>{e.stopPropagation(),l(t.content),s(null)},size:"small",children:(0,i.jsx)(y.A,{fontSize:"small",color:"success"})})}),(0,i.jsx)(x.A,{title:"취소",children:(0,i.jsx)(h.A,{onClick:e=>{e.stopPropagation(),s(null)},size:"small",children:(0,i.jsx)(v.A,{fontSize:"small",color:"error"})})})]}):null},T=e=>{let{item:t,editingKey:n,handleDelete:l}=e;return n?null:(0,i.jsx)(x.A,{title:"삭제",children:(0,i.jsx)(h.A,{onClick:e=>l(e,t),size:"small",children:(0,i.jsx)(a.A,{fontSize:"small",color:"error"})})})},L=e=>{var t,n;let{item:l,field:s,editingMap:r,handleEditChange:a,handleEnterSave:o}=e,d=null!==(n=null===(t=r[l.content])||void 0===t?void 0:t[s])&&void 0!==n?n:l[s],x="category"===s,h=x&&""===d;return(0,i.jsx)(c.A,{error:h,label:h?"필수":x?"카테고리":"내용",value:d,onChange:e=>a(l.content,s,e.target.value),size:"small",onKeyDown:e=>o(e,l.content)})},P=e=>{let{item:t,index:n,isEditing:l,isHover:s,rowRef:r,setHoverIndex:a,handleEdit:c,handleDelete:g,handleMoveSection:j,editingMap:u,handleEditChange:A,handleSaveEdit:m,handleEnterSave:p,editingKey:f,setEditingKey:y}=e,{attributes:v,listeners:b,setNodeRef:C,transform:k,transition:O,isDragging:D}=(0,z.gl)({id:t.content}),K={transform:I.Ks.Transform.toString(k),transition:O,opacity:D?.5:1};return(0,i.jsxs)(S.A,{ref:l?r:C,component:"tr",onMouseEnter:()=>a(n),onMouseLeave:()=>a(null),sx:{cursor:"pointer",...K},hover:!0,selected:l,onClick:e=>{e.stopPropagation(),c(t)},...v,children:[(0,i.jsx)(E.A,{sx:{width:{xs:"32px",sm:"40px"}},children:(0,i.jsx)(x.A,{title:"드래그로 순서 변경",children:(0,i.jsx)(h.A,{size:"small",sx:{cursor:"grab"},...b,children:(0,i.jsx)(w.A,{fontSize:"small"})})})}),(0,i.jsx)(E.A,{sx:{wordBreak:"break-all",minWidth:{xs:"120px",sm:"160px",md:"200px"},maxWidth:{xs:"200px",sm:"250px",md:"300px"}},children:l?(0,i.jsx)(L,{item:t,field:"category",editingMap:u,handleEditChange:A,handleEnterSave:p}):(0,i.jsx)(x.A,{title:"클릭해서 수정",children:(0,i.jsx)(d.A,{sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:t.category})})}),(0,i.jsx)(E.A,{sx:{wordBreak:"break-all",minWidth:{xs:"200px",sm:"300px",md:"400px"},maxWidth:{xs:"300px",sm:"400px",md:"600px"}},children:l?(0,i.jsx)(L,{item:t,field:"content",editingMap:u,handleEditChange:A,handleEnterSave:p}):(0,i.jsx)(x.A,{title:"클릭해서 수정",children:(0,i.jsx)(d.A,{sx:{whiteSpace:"pre-wrap",fontSize:{xs:"0.875rem",sm:"1rem"}},children:t.content})})}),(0,i.jsx)(E.A,{sx:{minWidth:{xs:"80px",sm:"100px"}},align:"right",children:l?(0,i.jsx)(N,{item:t,editingKey:f,handleSaveEdit:m,setEditingKey:y,handleMoveSection:j}):(0,i.jsxs)(o.A,{display:"flex",justifyContent:"flex-end",alignItems:"center",children:[t.section===_.TODAY&&(0,i.jsx)(x.A,{title:"익일로 이동",children:(0,i.jsx)(h.A,{onClick:e=>j(e,t.content,_.TOMORROW),size:"small",children:(0,i.jsx)(R.A,{fontSize:"small",color:"primary"})})}),t.section===_.TOMORROW&&(0,i.jsx)(x.A,{title:"금일로 이동",children:(0,i.jsx)(h.A,{onClick:e=>j(e,t.content,_.TODAY),size:"small",children:(0,i.jsx)(W.A,{fontSize:"small",color:"primary"})})}),(0,i.jsx)(T,{item:t,editingKey:f,handleDelete:g})]})})]})},H=()=>(0,i.jsx)(D.A,{children:(0,i.jsx)(M.A,{children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,i.jsxs)(S.A,{children:[(0,i.jsx)(E.A,{width:"30%",children:(0,i.jsx)(m.A,{variant:"text",width:"80%",height:24})}),(0,i.jsx)(E.A,{width:"50%",children:(0,i.jsx)(m.A,{variant:"text",width:"95%",height:24})}),(0,i.jsx)(E.A,{width:"20%",children:(0,i.jsxs)(o.A,{display:"flex",gap:1,children:[(0,i.jsx)(m.A,{variant:"rectangular",width:32,height:32}),(0,i.jsx)(m.A,{variant:"rectangular",width:32,height:32})]})})]},t))})}),J=e=>{let[t,n]=(0,A.useState)(!1),[l,s]=(0,A.useState)(null),r=(0,A.useRef)(null),[a,c]=(0,A.useState)(e.allContentItems),g=(0,k.FR)((0,k.MS)(k.AN),(0,k.MS)(k.uN,{coordinateGetter:z.JR}));(0,A.useEffect)(()=>{c(e.allContentItems)},[e.allContentItems]);let j=t=>{e.setEditingMap(e=>({...e,[t.content]:{...t}})),e.setEditingKey("".concat(t.section,"-").concat(t.category,"-").concat(t.content))},u=(t,n)=>{"Enter"===t.key&&(e.handleSaveEdit(n),e.setEditingKey(null))},m=(t,n,i)=>{t.stopPropagation(),e.handleSaveEdit(n,i)},p=(t,n)=>{t.stopPropagation(),e.handleDelete(n.section,n.category,n.content),e.setEditingKey(null)};return((0,A.useEffect)(()=>{let t=t=>{e.editingKey&&r.current&&!r.current.contains(t.target)&&e.setEditingKey(null)};return e.editingKey&&document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[e.editingKey]),e.isLoading)?(0,i.jsx)(H,{}):(0,i.jsxs)(o.A,{sx:{overflowX:"auto",minHeight:"200px"},children:[(0,i.jsxs)(o.A,{display:"flex",alignItems:"center",children:[(0,i.jsx)(d.A,{variant:"subtitle1",fontWeight:"bold",children:e.section}),(0,i.jsx)(x.A,{title:"추가하기",children:(0,i.jsx)(h.A,{onClick:()=>n(!0),size:"small",children:(0,i.jsx)(O.A,{fontSize:"small",color:"primary"})})})]}),(0,i.jsx)(k.Mp,{sensors:g,collisionDetection:k.fp,onDragEnd:t=>{let{active:n,over:i}=t;if(i&&n.id!==i.id){let t=a.findIndex(e=>e.content===n.id),l=a.findIndex(e=>e.content===i.id),s=(0,z.be)(a,t,l);c(s),e.handleOrderChange(s.map(e=>({section:e.section,category:e.category,content:e.content})))}},children:(0,i.jsxs)(D.A,{size:"small",sx:{minWidth:300},children:[(0,i.jsx)(K.A,{children:(0,i.jsxs)(S.A,{children:[(0,i.jsx)(E.A,{sx:{width:"40px"}}),(0,i.jsx)(E.A,{children:"카테고리"}),(0,i.jsx)(E.A,{children:"내용"}),(0,i.jsx)(E.A,{align:"right"})]})}),(0,i.jsxs)(M.A,{children:[t&&(0,i.jsx)(C,{section:e.section,handleAdd:e.handleAdd,setIsAdding:n,allContentItems:e.allContentItems}),(0,i.jsx)(z.gB,{items:a.map(e=>e.content),strategy:z._G,children:a.map((t,n)=>{let a="".concat(t.section,"-").concat(t.category,"-").concat(t.content),o=e.editingKey===a;return(0,i.jsx)(P,{item:t,index:n,isEditing:o,isHover:l===n,rowRef:r,setHoverIndex:s,handleEdit:j,handleDelete:p,handleMoveSection:m,editingMap:e.editingMap,handleEditChange:e.handleEditChange,handleSaveEdit:e.handleSaveEdit,handleEnterSave:u,editingKey:e.editingKey,setEditingKey:e.setEditingKey},a)})})]})]})})]})};var B=n(6924),X=n(42009);let Y=async(e,t)=>{try{let n=(0,X.H9)(B.db,"workReports",t.uid);(await (0,X.x7)(n)).exists()?await (0,X.mZ)(n,{workReportData:e,updatedAt:new Date}):await (0,X.BN)(n,{workReportData:e,createdAt:new Date})}catch(e){console.error("Failed to edit work report:",e)}},F=async e=>{try{let t=(0,X.H9)(B.db,"workReports",e.uid),n=await (0,X.x7)(t);if(n.exists())return JSON.parse(n.data().workReportData);return null}catch(e){return null}};var G=n(40197);let Z="workReportData",q=()=>{let[e,t]=(0,A.useState)({}),[n,i]=(0,A.useState)({}),[l,s]=(0,A.useState)(null),[r,a]=(0,A.useState)(!0),{user:o}=(0,G.A)(),d=()=>{t({})};(0,A.useEffect)(()=>{(async()=>{if(a(!0),o){let e=await F(o);e&&t(e)}else{let e=localStorage.getItem(Z);e&&t(JSON.parse(e))}a(!1)})()},[o]),(0,A.useEffect)(()=>{(async()=>{o?await Y(JSON.stringify(e),o):localStorage.setItem(Z,JSON.stringify(e))})()},[e,o,d]);let c=(e,l)=>{let s=h.find(t=>t.content===e);if(!s)return;let r=n[e],a=l||(null==r?void 0:r.section)||s.section,o=(null==r?void 0:r.category)||s.category,d=(null==r?void 0:r.content)||s.content;t(t=>{let n={...t};return n[s.section][s.category]=n[s.section][s.category].filter(t=>t!==e),0===n[s.section][s.category].length&&delete n[s.section][s.category],0===Object.keys(n[s.section]).length&&delete n[s.section],n[a]=n[a]||{},n[a][o]=[...n[a][o]||[],d],n}),i(t=>{let n={...t};return delete n[e],n})},x=Object.entries(e).sort((e,t)=>{let[n]=e,[i]=t;return n.localeCompare(i)}).map(e=>{let[t,n]=e,i=Object.entries(n).map(e=>{let[t,n]=e,i=n.filter(e=>""!==e.trim());if(0===i.length)return"● ".concat(t);let l=i.map(e=>"    ○ ".concat(e)).join("\n");return t.trim()?"● ".concat(t,"\n").concat(l):l}).join("\n");return i?"".concat("[".concat(t,"]"),"\n").concat(i):""}).join("\n\n").trim(),h=Object.entries(e).flatMap(e=>{let[t,n]=e;return Object.entries(n).flatMap(e=>{let[n,i]=e;return i.map(e=>({section:t,category:n,content:e}))})});return{handleAdd:(e,n,i)=>{e&&n&&(h.some(t=>t.section===e&&t.category===n&&t.content===i)||t(t=>{let l={...t};return l[e]=l[e]||{},l[e][n]=[...l[e][n]||[],i],l}))},allContentItems:h,editingMap:n,editingKey:l,handleEditChange:(e,t,n)=>{i(i=>({...i,[e]:{...i[e],[t]:n}}))},handleSaveEdit:c,setEditingMap:i,setEditingKey:s,handleDelete:(e,n,i)=>{t(t=>{let l={...t};return l[e][n]=l[e][n].filter(e=>e!==i),0===l[e][n].length&&delete l[e][n],0===Object.keys(l[e]).length&&delete l[e],l})},text:x,resetData:d,handleOrderChange:e=>{t(t=>{let n={};return e.forEach(e=>{n[e.section]||(n[e.section]={}),n[e.section][e.category]||(n[e.section][e.category]=[]),n[e.section][e.category].push(e.content)}),n})},isLoading:r,handleMoveSection:(e,t,n)=>{e.stopPropagation(),h.find(e=>e.content===t)&&c(t,n)}}};var Q=n(97916);let U=()=>{let{handleAdd:e,allContentItems:t,editingMap:n,editingKey:r,handleEditChange:a,handleSaveEdit:d,setEditingMap:c,setEditingKey:x,handleDelete:h,text:g,resetData:j,handleOrderChange:u,isLoading:A}=q();return(0,i.jsxs)(l.A,{children:[(0,i.jsx)(s.s,{title:"업무 보고 생성기",subTitle:"업무 보고를 템플릿으로 자동으로 생성 해줍니다. \n 로그인하면 클라우드에 저장됩니다."}),(0,i.jsx)(Q.A,{}),(0,i.jsxs)(o.A,{display:"flex",sx:{flexDirection:{xs:"column",sm:"row"}},children:[(0,i.jsxs)(o.A,{display:"flex",flexDirection:"column",gap:8,flex:2,children:[(0,i.jsx)(J,{allContentItems:t.filter(e=>"금일 진행 사항"===e.section),editingMap:n,setEditingMap:c,editingKey:r,setEditingKey:x,handleEditChange:a,handleSaveEdit:d,handleDelete:h,handleOrderChange:u,section:"금일 진행 사항",handleAdd:e,isLoading:A}),(0,i.jsx)(J,{allContentItems:t.filter(e=>"익일 예정 사항"===e.section),editingMap:n,setEditingMap:c,editingKey:r,setEditingKey:x,handleEditChange:a,handleSaveEdit:d,handleDelete:h,handleOrderChange:u,section:"익일 예정 사항",handleAdd:e,isLoading:A})]}),(0,i.jsx)(Q.A,{orientation:"vertical",flexItem:!0,sx:{mx:3,display:{xs:"none",sm:"block"}}}),(0,i.jsx)(Q.A,{sx:{my:3,display:{xs:"block",sm:"none"}}}),(0,i.jsx)(f,{text:g,resetData:j,isLoading:A})]})]})}},80132:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var i=n(37876),l=n(46520),s=n(61428);let r=e=>(0,i.jsxs)(l.A,{children:[(0,i.jsx)(s.A,{variant:"h5",fontWeight:"bold",children:e.title}),(0,i.jsx)(s.A,{variant:"body2",color:"text.secondary",mt:.5,children:e.subTitle.split("\n").map((e,t)=>(0,i.jsxs)("span",{children:[e,(0,i.jsx)("br",{})]},t))})]})},95252:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(37876),l=n(46520),s=n(87263);let r=e=>(0,i.jsx)(l.A,{p:2,children:(0,i.jsx)(s.A,{spacing:3,children:e.children})})}},e=>{var t=t=>e(e.s=t);e.O(0,[410,199,185,148,636,593,792],()=>t(18569)),_N_E=e.O()}]);