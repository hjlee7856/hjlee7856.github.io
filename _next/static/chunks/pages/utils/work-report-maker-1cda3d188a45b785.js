(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[119],{3853:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>B});var l=n(7876),i=n(9474),s=n(5582),a=n(4676),r=n(9858),o=n(3410),c=n(6448),d=n(4527),h=n(7461),x=n(4232);let j=e=>{let[t,n]=(0,x.useState)(""),[j,u]=(0,x.useState)(""),g=()=>{e.handleAdd(e.section,t,j),A(),e.setIsAdding(!1)},A=()=>{n(""),u(""),e.setIsAdding(!1)},m=e=>{"Enter"===e.key&&g()};return(0,l.jsxs)(a.A,{sx:{backgroundColor:h.A[50]},children:[(0,l.jsx)(r.A,{children:(0,l.jsx)(o.A,{error:""===t,label:""===t?"필수":"카테고리",value:t,onChange:e=>n(e.target.value),fullWidth:!0,size:"small",onKeyDown:m})}),(0,l.jsx)(r.A,{children:(0,l.jsx)(o.A,{label:"내용",value:j,onChange:e=>u(e.target.value),fullWidth:!0,size:"small",onKeyDown:m})}),(0,l.jsxs)(r.A,{align:"right",children:[(0,l.jsx)(c.A,{title:"저장",children:(0,l.jsx)(d.A,{onClick:g,size:"small",children:(0,l.jsx)(i.A,{fontSize:"small"})})}),(0,l.jsx)(c.A,{title:"취소",children:(0,l.jsx)(d.A,{onClick:A,size:"small",children:(0,l.jsx)(s.A,{fontSize:"small"})})})]})]})};var u=n(2989),g=n(2781),A=n(5878),m=n(6149),p=n(6115),y=n(6520),f=n(1428),v=n(451),k=n(8423),b=n(1413);let w=e=>{let[t,n]=(0,x.useState)(!1),[s,h]=(0,x.useState)(null),w=(t,n)=>{"Enter"===t.key&&e.handleSaveEdit(n)};return(0,l.jsxs)(y.A,{sx:{overflowX:"auto",minHeight:"200px"},children:[(0,l.jsxs)(y.A,{display:"flex",alignItems:"center",children:[(0,l.jsx)(f.A,{variant:"subtitle1",fontWeight:"bold",children:e.section}),(0,l.jsx)(c.A,{title:"추가하기",children:(0,l.jsx)(d.A,{onClick:()=>{n(!0)},size:"small",children:(0,l.jsx)(u.A,{fontSize:"small",color:"primary"})})})]}),(0,l.jsxs)(v.A,{size:"small",sx:{minWidth:300},children:[(0,l.jsx)(k.A,{children:(0,l.jsxs)(a.A,{children:[(0,l.jsx)(r.A,{children:"카테고리"}),(0,l.jsx)(r.A,{children:"내용"}),(0,l.jsx)(r.A,{align:"right"})]})}),(0,l.jsxs)(b.A,{children:[t&&(0,l.jsx)(j,{section:e.section,handleAdd:e.handleAdd,setIsAdding:n}),e.allContentItems.map((t,n)=>{var x,j,u,y,v,k;let b="".concat(t.section,"-").concat(t.category,"-").concat(t.content),E=e.editingKey===b,S=s===n;return(0,l.jsxs)(a.A,{component:"tr",onMouseEnter:()=>h(n),onMouseLeave:()=>h(null),sx:{cursor:"pointer"},hover:!0,selected:E,children:[(0,l.jsx)(r.A,{sx:{wordBreak:"break-all"},children:E?(0,l.jsx)(o.A,{error:(null===(x=e.editingMap[t.content])||void 0===x?void 0:x.category)==="",label:(null===(j=e.editingMap[t.content])||void 0===j?void 0:j.category)===""?"필수":"카테고리",value:null!==(v=null===(u=e.editingMap[t.content])||void 0===u?void 0:u.category)&&void 0!==v?v:t.category,onChange:n=>e.handleEditChange(t.content,"category",n.target.value),size:"small",onKeyDown:e=>w(e,t.content)}):(0,l.jsx)(f.A,{children:t.category})}),(0,l.jsx)(r.A,{sx:{wordBreak:"break-all"},children:E?(0,l.jsx)(o.A,{label:"내용",value:null!==(k=null===(y=e.editingMap[t.content])||void 0===y?void 0:y.content)&&void 0!==k?k:t.content,onChange:n=>e.handleEditChange(t.content,"content",n.target.value),disabled:!E,size:"small",onKeyDown:e=>w(e,t.content)}):(0,l.jsx)(f.A,{children:t.content})}),E&&(0,l.jsxs)(r.A,{align:"right",sx:{minWidth:"150px"},children:[(0,l.jsx)(c.A,{title:"저장",children:(0,l.jsx)(d.A,{onClick:()=>{e.handleSaveEdit(t.content),e.setEditingKey(null)},size:"small",children:(0,l.jsx)(i.A,{fontSize:"small",color:"success"})})}),"금일 진행 사항"===t.section&&(0,l.jsx)(c.A,{title:"익일로 이동",children:(0,l.jsx)(d.A,{onClick:()=>{e.handleEditChange(t.content,"section","익일 예정 사항"),e.handleSaveEdit(t.content,"익일 예정 사항"),e.setEditingKey(null)},size:"small",children:(0,l.jsx)(p.A,{fontSize:"small",color:"primary"})})}),"익일 예정 사항"===t.section&&(0,l.jsx)(c.A,{title:"금일로 이동",children:(0,l.jsx)(d.A,{onClick:()=>{e.handleEditChange(t.content,"section","금일 진행 사항"),e.handleSaveEdit(t.content,"금일 진행 사항"),e.setEditingKey(null)},size:"small",children:(0,l.jsx)(m.A,{fontSize:"small",color:"primary"})})})]}),S&&!E&&(0,l.jsxs)(r.A,{align:"right",sx:{minWidth:"150px"},children:[(0,l.jsx)(c.A,{title:"수정",children:(0,l.jsx)(d.A,{onClick:()=>{e.setEditingMap(e=>({...e,[t.content]:{section:t.section,category:t.category,content:t.content}})),e.setEditingKey("".concat(t.section,"-").concat(t.category,"-").concat(t.content))},size:"small",children:(0,l.jsx)(A.A,{fontSize:"small",color:"primary"})})}),(0,l.jsx)(c.A,{title:"삭제",children:(0,l.jsx)(d.A,{onClick:()=>{e.handleDelete(t.section,t.category,t.content),e.setEditingKey(null)},size:"small",children:(0,l.jsx)(g.A,{fontSize:"small",color:"error"})})})]}),!S&&!E&&(0,l.jsx)(r.A,{sx:{minWidth:"150px"}})]},b)})]})]})]})};var E=n(2382),S=n(3890),C=n(4694),z=n(2199);let D=e=>{let[t,n]=(0,x.useState)(!1),[i,s]=(0,x.useState)(!1),[a,r]=(0,x.useState)(!1),[h,j]=(0,x.useState)(""),[u,A]=(0,x.useState)(!1),m=async()=>{await navigator.clipboard.writeText(h),A(!0)};return(0,x.useEffect)(()=>{let n=e.text.split("\n"),l=n[0];l=l.replace(/\s*\(오전 반차\)/,"").replace(/\s*\(오후 반차\)/,""),i?l+=" (오전 반차)":a&&(l+=" (오후 반차)"),n[0]=l;let s=n.join("\n");t&&(s+="\n@devops"),j(s)},[e.text,t,i,a]),(0,l.jsxs)(y.A,{flex:1,flexDirection:"column",children:[(0,l.jsx)(y.A,{display:"flex",flex:1,mb:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:(0,l.jsx)(f.A,{variant:"subtitle1",fontWeight:"bold",children:"미리보기"})}),(0,l.jsxs)(y.A,{position:"relative",children:[(0,l.jsx)(o.A,{multiline:!0,fullWidth:!0,minRows:10,value:h,onChange:e=>j(e.target.value),sx:{borderRadius:2}}),(0,l.jsx)(c.A,{title:"클립보드에 복사",sx:{position:"absolute",right:1,top:1},children:(0,l.jsx)(d.A,{size:"small",onClick:m,children:(0,l.jsx)(E.A,{fontSize:"small"})})}),(0,l.jsx)(c.A,{title:"초기화",sx:{position:"absolute",right:1,bottom:1},children:(0,l.jsx)(d.A,{size:"small",onClick:()=>{n(!1),j(""),e.resetData()},children:(0,l.jsx)(g.A,{fontSize:"small",color:"error"})})})]}),(0,l.jsx)(S.A,{control:(0,l.jsx)(C.A,{checked:t,onChange:e=>n(e.target.checked)}),label:"개발팀"}),(0,l.jsx)(S.A,{control:(0,l.jsx)(C.A,{checked:i,onChange:e=>{s(e.target.checked),r(!1)}}),label:"오전반차"}),(0,l.jsx)(S.A,{control:(0,l.jsx)(C.A,{checked:a,onChange:e=>{s(!1),r(e.target.checked)}}),label:"오후반차"}),(0,l.jsx)(z.A,{open:u,autoHideDuration:2e3,onClose:()=>A(!1),message:"보고서가 클립보드에 복사되었습니다.",anchorOrigin:{vertical:"bottom",horizontal:"center"}})]})},K=()=>(0,l.jsxs)(y.A,{children:[(0,l.jsx)(f.A,{variant:"h5",fontWeight:"bold",children:"업무 보고 생성기"}),(0,l.jsxs)(f.A,{variant:"body2",color:"text.secondary",mt:.5,children:["업무 보고를 템플릿으로 자동으로 생성 해줍니다. ",(0,l.jsx)("br",{}),"로그인하면 클라우드에 저장됩니다."]})]});var M=n(6924),O=n(2009);let _=async(e,t)=>{try{let n=(0,O.H9)(M.db,"workReports",t.uid);(await (0,O.x7)(n)).exists()?await (0,O.mZ)(n,{workReportData:e,updatedAt:new Date}):await (0,O.BN)(n,{workReportData:e,createdAt:new Date})}catch(e){console.error("Failed to edit work report:",e)}},I=async e=>{try{let t=(0,O.H9)(M.db,"workReports",e.uid),n=await (0,O.x7)(t);if(n.exists())return JSON.parse(n.data().workReportData);return null}catch(e){return null}};var N=n(197);let W="workReportData",R=()=>{let[e,t]=(0,x.useState)({}),[n,l]=(0,x.useState)({}),[i,s]=(0,x.useState)(null),{user:a}=(0,N.A)(),r=()=>{t({})};(0,x.useEffect)(()=>{(async()=>{if(a){let e=await I(a);e&&t(e)}else{let e=localStorage.getItem(W);e&&t(JSON.parse(e))}})()},[a]),(0,x.useEffect)(()=>{(async()=>{a?await _(JSON.stringify(e),a):localStorage.setItem(W,JSON.stringify(e))})()},[e,a,r]);let o=Object.entries(e).sort((e,t)=>{let[n]=e,[l]=t;return n.localeCompare(l)}).map(e=>{let[t,n]=e,l=Object.entries(n).map(e=>{let[t,n]=e,l=n.filter(e=>""!==e.trim());if(0===l.length)return"● ".concat(t);let i=l.map(e=>"    ○ ".concat(e)).join("\n");return t.trim()?"● ".concat(t,"\n").concat(i):i}).join("\n");return l?"".concat("*[".concat(t,"]*"),"\n").concat(l):""}).join("\n\n").trim(),c=Object.entries(e).flatMap(e=>{let[t,n]=e;return Object.entries(n).flatMap(e=>{let[n,l]=e;return l.map(e=>({section:t,category:n,content:e}))})});return{handleAdd:(e,n,l)=>{e&&n&&t(t=>{let i={...t};return i[e]=i[e]||{},i[e][n]=[...i[e][n]||[],l],i})},allContentItems:c,editingMap:n,editingKey:i,handleEditChange:(e,t,n)=>{l(l=>({...l,[e]:{...l[e],[t]:n}}))},handleSaveEdit:(e,i)=>{let s=n[e];if(!s)return;let a=c.find(t=>t.content===e);if(!a)return;let r=i||s.section,o=s.category,d=s.content;t(t=>{let n={...t};return n[a.section][a.category]=n[a.section][a.category].filter(t=>t!==e),0===n[a.section][a.category].length&&delete n[a.section][a.category],0===Object.keys(n[a.section]).length&&delete n[a.section],n[r]=n[r]||{},n[r][o]=[...n[r][o]||[],d],n}),l(t=>{let n={...t};return delete n[e],n})},setEditingMap:l,setEditingKey:s,handleDelete:(e,n,l)=>{t(t=>{let i={...t};return i[e][n]=i[e][n].filter(e=>e!==l),0===i[e][n].length&&delete i[e][n],0===Object.keys(i[e]).length&&delete i[e],i})},text:o,resetData:r}};var H=n(7263),J=n(7916);let B=()=>{let{handleAdd:e,allContentItems:t,editingMap:n,editingKey:i,handleEditChange:s,handleSaveEdit:a,setEditingMap:r,setEditingKey:o,handleDelete:c,text:d,resetData:h}=R();return(0,l.jsx)(y.A,{p:2,children:(0,l.jsxs)(H.A,{spacing:3,children:[(0,l.jsx)(K,{}),(0,l.jsx)(J.A,{}),(0,l.jsxs)(y.A,{display:"flex",sx:{flexDirection:{xs:"column",sm:"row"}},children:[(0,l.jsxs)(y.A,{display:"flex",flexDirection:"column",gap:8,flex:2,children:[(0,l.jsx)(w,{allContentItems:t.filter(e=>"금일 진행 사항"===e.section),editingMap:n,setEditingMap:r,editingKey:i,setEditingKey:o,handleEditChange:s,handleSaveEdit:a,handleDelete:c,section:"금일 진행 사항",handleAdd:e}),(0,l.jsx)(w,{allContentItems:t.filter(e=>"익일 예정 사항"===e.section),editingMap:n,setEditingMap:r,editingKey:i,setEditingKey:o,handleEditChange:s,handleSaveEdit:a,handleDelete:c,section:"익일 예정 사항",handleAdd:e})]}),(0,l.jsx)(J.A,{orientation:"vertical",flexItem:!0,sx:{mx:3,display:{xs:"none",sm:"block"}}}),(0,l.jsx)(J.A,{sx:{my:3,display:{xs:"block",sm:"none"}}}),(0,l.jsx)(D,{text:d,resetData:h})]})]})})}},8569:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/utils/work-report-maker",function(){return n(3853)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[410,341,294,636,593,792],()=>t(8569)),_N_E=e.O()}]);